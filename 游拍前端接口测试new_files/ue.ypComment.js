function upgraded(){if(Emt.isYoupai){if(Emt.isIDevice&&ckYpVernum<"1.6.0")return void showToast("版本过低，无法参与评论，速去升级哦~");Emt.isAndroid&&ckYpVernum<"1.5.0"&&setTimeout(function(){document.location.href="protocol://toCheckver"},800)}else showToast("非游拍环境或版本过低，无法参与评论")}function overHidden(t){t?(iscroll=!1,$("body").css("overflow","hidden"),$(".m-layout").show()):(iscroll=!0,$("body").css("overflow","auto"),$(".m-layout").hide())}var comId,isload=0,content_txt=[],toAuthorContent,is_iOS_wkwebview=!1,m_comment,uid,num,content=[],isget=!1,c_more,v_uid,c_url,v_height,iserror=!1,cur_uid,isUp=!1,is_active,isVer,verCode="";v_height=$(window).height(),window.callMobile=function(t,e,i){var n={handlerInterface:t,function:e,parameters:i};Emt.isYoupai&&Emt.isIDevice&&window.webkit.messageHandlers[t].postMessage(n)},Emt.isYoupai&&Emt.isIDevice&&callMobile("Native","setWKWebViewEnv"),window.setWKWebViewEnv=function(){is_iOS_wkwebview=!0},"1.8.0"!=ckYpVernum&&"1.8.1"!=ckYpVernum||setWKWebViewEnv(),window.comAPI=window.ClientAPI||{toReply:function(t,e,i,n,o){0==is_iOS_wkwebview?upgraded():callMobile("Native","toReply",{cid:t,to_nick:e,to_uid:i,froot:n,toAuthorContent:o})},toReplyChild:function(t,e,i,n,o,a){0==is_iOS_wkwebview?upgraded():callMobile("Native","toReplyChild",{cid:t,chid:e,to_nick:i,to_uid:n,froot:o,toAuthorContent:a})},visitPersonPage:function(t,e){0==is_iOS_wkwebview?upgraded():callMobile("Native","visitPersonPage",{from_uid:t,nick:e})},setCommentCount:function(t){1==is_iOS_wkwebview&&callMobile("Native","setCommentCount",{num:t})},toDelete:function(t,e,i,n){1==is_iOS_wkwebview&&callMobile("Native","toDelete",{cid:t,cuid:e,chid:i,chuid:n})},toComment:function(){0==is_iOS_wkwebview?upgraded():callMobile("Native","toComment",{})},loadMoreReply:function(){},toAudit:function(t,e,i){1==is_iOS_wkwebview&&callMobile("Native","toAudit",{uid:t,cid:e,chid:i})},onJsToast:function(t){1==is_iOS_wkwebview&&callMobile("Native","onJsToast",{msg:t})},onJsPlayVideo:function(t,e){1==is_iOS_wkwebview&&callMobile("Native","onJsPlayVideo",{video_title:t,video_url:e})}};var globalCallback={publishComment:function(t,e,i,n,o){m_comment.newComment(t,e,i,n,o)},publishCommentReply:function(t,e,i,n,o){m_comment.newReply(t,e,i,n,o)},publishCommentReplyChild:function(t,e,i,n,o,a,r){m_comment.newReplyChild(t,e,i,n,o,a,r)},publishCommentDel:function(t){m_comment.delComm(t)},publishUpdateUid:function(t){m_comment.updateUid(t)}};Emt.isAndroid?"function"==typeof comAPI.getVersionCode?(isVer=!0,verCode=comAPI.getVersionCode()):isVer=!1:Emt.isIDevice&&(isVer=!0);var iscroll=!0;document.addEventListener("touchmove",function(t){iscroll||(t.preventDefault(),t.stopPropagation())},!1),$(".m-layout").bind("click",function(){$(".m-comm_del").hide(),overHidden(0)});var emoji_url="http://m.img4399.com/r/youpai/release/images/com/",M_Comment=function(t,e,i,n){this.pl_total=-1,this.pl_page=1,this.is_load_over=!1,this.firstLoadNum=12,this.loadPerNum=12,this.comments=[],this.aid=t,this.uid=n,this.newCommentScrollTop=i,this.autoLoadMore=e},classList={contains:function(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},add:function(t,e){this.contains(t,e)||(t.className+=" "+e)},remove:function(t,e){if(this.contains(t,e)){var i=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(i," ")}}};M_Comment.prototype={init:function(t,e,i,n){this.aid=t,is_active=n||!0,c_url=is_active&&0==is_active?e+"json/comment/":e+"json/comment/hd/",i?cur_uid=i:this.updateUid();var o=this,a=document.getElementById("j-com_container");document.getElementById("j-comment").innerHTML='                <div class="comment_hd">                    <div class="count pr"><i class="i_count pa"></i><span id="j-comment_count">0</span>条评论</div>                </div>                <div class="comment_main">                    <ul class="comment_list" id="j-comment_list"></ul>                    <div class="load_more hashover load_more_comment loading" id="j-load_more_comment">评论加载中...</div>                </div>',a.addEventListener("click",function(t){t.target,o.handleEvent(t)},!0),!0===o.autoLoadMore&&window.addEventListener("scroll",function(){var t=window.innerHeight||document.documentElement.clientHeight,e=document.getElementById("j-load_more_comment"),i=e.offsetTop;if("false"==e.getAttribute("data-more"))return void(e.innerHTML="没有更多咯~");window.scrollY+t>=i-200&&o.handleEvent({target:e})},!1),o.showComments(1)},handleEvent:function(t){var e=this,i=t.target;if("j-load_more_comment"==i.id){if(iserror)return;if(iserror=!1,"function"==typeof e.autoLoadMore)return e.autoLoadMore.call(e),!1;var n=parseInt(i.getAttribute("data-page"))||1;return!classList.contains(i,"nodata")&&!classList.contains(i,"loading")&&(classList.add(i,"loading"),i.innerHTML="加载更多评论...",i.setAttribute("data-more",c_more),n++,i.setAttribute("data-page",n),e.showComments(n),!1)}if(classList.contains(i,"load_more_reply")||classList.contains(i.parentNode,"load_more_reply")){var o=classList.contains(i,"load_more_reply")?i:i.parentNode,a=(o.getAttribute("data-cid"),o.getAttribute("data-chid"));if(iserror)return;iserror=!1;if(!o.getAttribute("data-more")||1==isload)return;var r="#reply_list_"+a;$(r).find("li.reply_meta_li").remove(),isload=1,e.getComChild(a,o),e.onresize()}else if(classList.contains(i,"j-v_comment_form")||classList.contains(i.parentNode,"j-v_comment_form"))comAPI.toComment();else if(classList.contains(i,"btn_reply")||classList.contains(i.parentNode,"btn_reply")){var o=classList.contains(i,"btn_reply")?i:i.parentNode,c=o.getAttribute("data-cid"),s=o.getAttribute("data-nick"),d=o.getAttribute("data-uid"),l=1;e.toauthorContent(c),comId=c;var m=isVer?d:parseInt(d);comAPI.toReply(parseInt(c),s,m,parseInt(l),h)}else if(classList.contains(i,"content")){var c=i.getAttribute("data-cid"),s=i.getAttribute("data-nick"),d=i.getAttribute("data-uid"),l=1;if(cur_uid&&cur_uid==d||isUp)$(".m-comm_del").show(),overHidden(1),$(".i-del").removeClass("j-chom_del").addClass("j-comm_del"),$(".i-rep").removeClass("j-chom_reply").addClass("j-comm_reply"),$(".i-del").attr({cid:c,cuid:d,comId:c}),$(".i-rep").attr({cid:c,nick:s,uid:d,root:parseInt(l),comId:c});else{e.toauthorContent(c),comId=c;var m=isVer?d:parseInt(d);comAPI.toReply(parseInt(c),s,m,parseInt(l),h)}}else if(classList.contains(i.parentNode,"content")){var c=i.parentNode.getAttribute("data-cid"),s=i.parentNode.getAttribute("data-nick"),d=i.parentNode.getAttribute("data-uid"),l=1;if(cur_uid&&cur_uid==d||isUp)$(".m-comm_del").show(),overHidden(1),$(".i-del").removeClass("j-chom_del").addClass("j-comm_del"),$(".i-rep").removeClass("j-chom_reply").addClass("j-comm_reply"),$(".i-del").attr({cid:c,cuid:d,comId:c}),$(".i-rep").attr({cid:c,nick:s,uid:d,root:parseInt(l),comId:c});else{e.toauthorContent(c),comId=c;var m=isVer?d:parseInt(d);comAPI.toReply(parseInt(c),s,m,parseInt(l),h)}}else if(classList.contains(i,"avatar")||classList.contains(i,"nick")||classList.contains(i.parentNode,"nick")){var o=classList.contains(i,"nick")?i:i.parentNode,m=isVer?o.getAttribute("data-uid"):parseInt(o.getAttribute("data-uid"));comAPI.visitPersonPage(m,o.getAttribute("data-nick"))}else if(classList.contains(i.parentNode,"avatar")||classList.contains(i.parentNode,"nick")){var m=isVer?i.parentNode.getAttribute("data-uid"):parseInt(i.parentNode.getAttribute("data-uid"));comAPI.visitPersonPage(m,i.parentNode.getAttribute("data-nick"))}else if(classList.contains(i,"j-reply_nick")||classList.contains(i.parentNode,"j-reply_nick")){var o=classList.contains(i,"j-reply_nick")?i:i.parentNode,d=o.getAttribute("data-uid"),s=o.getAttribute("data-nick");if(0!=parseInt(d)){var m=isVer?d:parseInt(d);comAPI.visitPersonPage(m,s)}}else if(classList.contains(i,"reply_meta")||classList.contains(i.parentNode,"reply_meta")||classList.contains(i.parentNode.parentNode,"reply_meta")){var o;o=classList.contains(i,"reply_meta")?i:classList.contains(i.parentNode,"reply_meta")?i.parentNode:i.parentNode.parentNode;var u=o.getAttribute("id").split("_"),c=u[1],_=u[2],s=o.getAttribute("data-nick"),d=o.getAttribute("data-uid"),p=0,v="#"+o.id,f=$(v).find(".reply_content").html().split("："),h=f[1];if(cur_uid&&cur_uid==d||isUp){var g="#comment_id_"+c,y=$(g).find(".com_info_hd .avatar").attr("data-uid");$(".m-comm_del").show(),overHidden(1),$(".i-del").removeClass("j-comm_del").addClass("j-chom_del"),$(".i-rep").removeClass("j-comm_reply").addClass("j-chom_reply"),$(".i-del").attr({cid:c,cuid:y,chid:_,chuid:d,comId:u}),$(".i-rep").attr({cid:c,chid:_,nick:s,uid:d,root:p,comId:u})}else{e.toauthorContent(c,_),comId=u;var m=isVer?d:parseInt(d);comAPI.toReplyChild(parseInt(c),parseInt(_),s,m,parseInt(p),h)}}else if(classList.contains(i,"j-comm_del")){var c=i.getAttribute("cid"),k=i.getAttribute("cuid");c&&(comId=i.getAttribute("comId"),comAPI.toDelete(parseInt(c),k,parseInt(-1),-1),$(".m-comm_del").hide(),overHidden(0))}else if(classList.contains(i,"j-comm_reply")){var c=i.getAttribute("cid"),s=i.getAttribute("nick"),d=i.getAttribute("uid"),p=i.getAttribute("root");if(c){e.toauthorContent(c),comId=i.getAttribute("comId");var m=isVer?d:parseInt(d);comAPI.toReply(parseInt(c),s,m,parseInt(p),h),$(".m-comm_del").hide(),overHidden(0)}}else if(classList.contains(i,"j-chom_del")){var c=i.getAttribute("cid"),k=i.getAttribute("cuid"),_=i.getAttribute("chid"),C=i.getAttribute("chuid");c&&_&&(comId=i.getAttribute("comId").split(","),comAPI.toDelete(parseInt(c),k,parseInt(_),C),$(".m-comm_del").hide(),overHidden(0))}else if(classList.contains(i,"j-chom_reply")){var c=i.getAttribute("cid"),_=i.getAttribute("chid"),s=i.getAttribute("nick"),d=i.getAttribute("uid"),p=i.getAttribute("root");if(c&&_){e.toauthorContent(c,_),comId=i.getAttribute("comId").split(",");var m=isVer?d:parseInt(d);comAPI.toReplyChild(parseInt(c),parseInt(_),s,m,parseInt(p),h),$(".m-comm_del").hide(),overHidden(0)}}},updateUid:function(t){cur_uid=t},toauthorContent:function(t,e){var n=content_txt.length;if(t)if(e){for(i=0;i<n;i++)if(content_txt[i].id==t){var o=content_txt[i].child;if(o)for(j=0;j<o.length;j++)o[j].id==e&&(toAuthorContent=o[j].content)}}else for(i=0;i<n;i++)content_txt[i].id==t&&(toAuthorContent=content_txt[i].content)},checkNoComments:function(t,e){var i=this,n=document.getElementById("j-load_more_comment");if(0==t){if(classList.remove(n,"loading"),classList.remove(n,"hashover"),classList.remove(n,"nodata_tip"),classList.add(n,"nodata"),n.innerHTML="没有更多咯~",0==this.comments.length)return classList.add(n,"nodata_tip"),void(n.innerHTML="<div class='com_none'></div><div class='com-tip'>期待你的精彩评论！</div>");1==e&&(classList.add(n,"nodata_visible"),n.innerHTML=" ")}else classList.remove(n,"loading"),classList.remove(n,"nodata_tip"),1==i.autoLoadMore?n.innerHTML="向下拉，查看更多评论...":n.innerHTML="点击查看更多评论"},getComments:function(t){var e,i=this,n=i.aid;isget=!0,e=is_active&&0==is_active?c_url+n+"/"+i.pl_page+".html":c_url+n+"_"+i.pl_page+".html";var o=function(e){var n=e;num=n.result.total,c_more=n.result.more,content=n.result.data,v_uid=n.result.video_uid,content_txt=content_txt.concat(content),cur_uid&&cur_uid==v_uid&&(isUp=!0),isget=!1,i.loadCommentSuccess(t),i.loadCommentError()},a=function(){var t=document.getElementById("j-load_more_comment");classList.add(t,"nodata_tip"),t.innerHTML="<div class='com_no'></div><div class='com-tip'>加载失败，点击重新加载！</div>",iserror=!0,$("body").delegate(".nodata_tip","click",function(){i.init(n,curl_pre)})};i.async(e,o,a)},loadCommentSuccess:function(t){var e=this;try{content=content||[]}catch(t){return void e.loadCommentError()}for(var i=[],n=0;n<content.length;n++){var o={avatar:content[n].from_authorImg,from_uid:content[n].from_uid,from_vip:content[n].from_author_vip,content:e.parseContent(content[n].content),id:content[n].id,relate_id:content[n].relate_id,star:2*content[n].star,nick:e.parseNick(content[n].from_uid,content[n].ip,content[n].from_author),created:e.parseDate(content[n].dateline),child:[],from:e.parseDevice(content[n].channel,content[n].user_agent),child_more:content[n].child_more,child_total:content[n].child_total};if(content[n].child)for(var a=0;a<content[n].child.length;a++){var r={id:content[n].child[a].id,avatar:content[n].child[a].from_authorImg,from_uid:content[n].child[a].from_uid,content:e.parseContent(content[n].child[a].content),nick:e.parseNick(content[n].child[a].from_uid,content[n].child[a].ip,content[n].child[a].from_author),created:e.parseDate(content[n].child[a].dateline),from_root:content[n].child[a].from_root,to_uid:content[n].child[a].to_uid,to_uid_author:e.parseNick(content[n].child[a].to_uid,content[n].child[a].ip,content[n].child[a].to_uid_author),parent_id:content[n].child[a].parent_id};o.child[a]=r}i.push(o)}Array.prototype.push.apply(e.comments,i),1==e.pl_page&&(e.pl_total=num,num&&(document.getElementById("j-comment_count").innerHTML=num)),e.pl_page++;var c=1;(0==c_more||content.length<12)&&(c=0),"function"==typeof t&&t.call(e,c)},parseDevice:function(t,e){if(void 0===t)return"";var i="4399.cn";return 2!=t&&1!=t||(i=e,e||(i="4399游戏盒")),i},loadCommentError:function(){var t=this,e=document.getElementById("j-load_more_comment"),i=e.getAttribute("data-more");t.pl_total>0?0==i&&(classList.remove(e,"loading"),classList.remove(e,"hashover"),classList.add(e,"nodata"),classList.remove(e,"nodata_tip"),e.innerHTML="没有更多咯~"):(classList.add(e,"nodata_tip"),e.innerHTML="<div class='com_none'></div><div class='com-tip'>期待你的精彩评论！</div>")},parseDate:function(t){var e="",i=parseInt(Date.parse(new Date)/1e3-t),n=new Date(1e3*t),o=new Date,a=(n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1)+"月"+(n.getDate()<10?"0"+n.getDate():n.getDate())+"日";if(i<=60)e="刚刚";else if(o.getFullYear()==n.getFullYear()&&o.getMonth()==n.getMonth()&&o.getDate()==n.getDate()){var r=o.getHours()-n.getHours(),c=o.getMinutes()-n.getMinutes();e=r>0?r+"小时前":c+"分钟前"}else e=o.getFullYear()==n.getFullYear()&&o.getMonth()==n.getMonth()&&o.getDate()-1==n.getDate()?"昨天":o.getFullYear()==n.getFullYear()&&o.getMonth()==n.getMonth()&&o.getDate()-2==n.getDate()?"2天前":o.getFullYear()==n.getFullYear()&&o.getMonth()==n.getMonth()&&o.getDate()-3==n.getDate()?"3天前":o.getFullYear()==n.getFullYear()&&o.getMonth()==n.getMonth()&&o.getDate()-4==n.getDate()?"4天前":o.getFullYear()==n.getFullYear()&&o.getMonth()==n.getMonth()&&o.getDate()-5==n.getDate()?"5天前":o.getFullYear()==n.getFullYear()&&o.getMonth()==n.getMonth()&&o.getDate()-6==n.getDate()?"6天前":o.getFullYear()==n.getFullYear()&&o.getMonth()==n.getMonth()&&o.getDate()-7==n.getDate()?"7天前":o.getFullYear()==n.getFullYear()?o.getFullYear()+"年"+a:n.getFullYear()+"年"+a;return e},parseContent:function(t){var e=this;return"string"!=typeof t?"":(t=e.htmlEncode(t),t=t.replace(/src=["']?(\/images(\/\w+)?\/\d+\.gif)["']?/gi,function(t,e){return c_url+e}),t=t.replace(/\[(\w+):(\d+)\]/gi,function(t,e,i){return'<img src="'+emoji_url+"emojis/m4399_png_emoji_"+e+"_"+i+'.png" />'}),t.trim())},getComChild:function(t,e){var i=this,n=i.aid,o=e.getAttribute("data-page")||2;ch_url=is_active&&0==is_active?c_url+n+"_"+t+"/"+o+".html":c_url+n+"_"+t+"_"+o+".html";var a=function(t){e.setAttribute("data-more",t.result.more?"1":""),e.setAttribute("data-page",++o),i.showComChild(t.result,e,o)},r=function(){iserror=!0,i.getComChild(t,e)};i.async(ch_url,a,r)},showComChild:function(t,e,i){var n=this,o=t.data,a=t.more,r=t.count;for(var c in o){var s={from_uid:o[c].from_uid,content:n.parseContent(o[c].content),id:n.parseContent(o[c].id),from_author:n.parseNick(o[c].from_uid,o[c].ip,o[c].from_author),from_root:o[c].from_root,to_uid:o[c].to_uid,to_uid_author:n.parseNick(o[c].to_uid,o[c].ip,o[c].to_uid_author),parent_id:o[c].parent_id},d=document.createElement("li");d.className="reply";var l="";l+='  <div class="reply_meta clearfix"  id="r_'+s.parent_id+"_"+s.id+'" data-nick="'+s.from_author+'"  data-uid="'+s.from_uid+'" data-froot="'+s.from_root+'">                                                <span class="j-reply_nick" data-uid="'+s.from_uid+'" data-nick="'+s.from_author+'">',v_uid==s.from_uid&&(l+='<span class="i_upz"></span>'),l+='<span class="reply_nick">'+s.from_author+"</span> ",0==s.from_root&&(l+='</span><span class="re_txt">回复</span>                                                  <span class="j-reply_nick" data-uid="'+s.to_uid+'" data-nick="'+s.to_uid_author+'">'),v_uid==s.to_uid&&(l+='<span class="i_upz"></span>'),l+='<span class="reply_nick">@'+s.to_uid_author+"</span> ",l+='</span><span class="reply_content">：'+s.content+"</span>                                        </div>",d.innerHTML=l,e.previousSibling.appendChild(d)}a?(e.setAttribute("data-ctotal",r),e.childNodes[1].innerHTML=parseInt(r-5*(i-1))):e.innerHTML="",isload=0},parseNick:function(t,e,i){var n=i;return 0==t&&(n=e?"4399"+e+"网友":"4399网友"),n},checkCache:function(t,e,i,n){var o=this;if(o.comments.length<=i&&!o.is_load_over){if(isget)return;o.getComments(function(a){if(o.comments.length==o.pl_total&&o.pl_total>=0){o.is_load_over=!0;var r=document.getElementById("j-load_more_comment");r.getAttribute("data-more");t>1&&(classList.remove(r,"loading"),classList.add(r,"nodata_visible"),r.innerHTML="没有更多咯~",r.setAttribute("data-more",!1))}0==a?(o.is_load_over=!0,"function"==typeof n&&n.call(o)):o.checkCache(t,i,n);var c=Array.prototype.slice.call(o.comments,e,i),s=document.getElementById("j-comment_list");o.renderCommentList(s,c),o.checkNoComments(a,t)})}else"function"==typeof n&&n.call(o)},showComments:function(t,e){var i,n,o=this;1==t?(i=0,n=o.firstLoadNum):(i=(t-2)*o.loadPerNum+o.firstLoadNum,n=(t-1)*o.loadPerNum+o.firstLoadNum),o.checkCache(t,i,n)},renderCommentList:function(t,e){for(var i=this,n=0;n<e.length;n++){var o=i.renderComment(e[n]);o=Array.prototype.slice.call(o,0),o.forEach(function(e,i){t.appendChild(e)})}i.onresize()},renderComment:function(t){var e,i,n="";i=document.createElement("li"),i.className="item",i.id="comment_id_"+(t.id||0),n+='  <div class="com_info_hd">                           <div class="avatar" data-uid="'+t.from_uid+'" data-nick="'+t.nick+'">',1==parseInt(t.from_vip)&&(n+='<div class="i_vip pa"></div>'),n+='<img src="'+t.avatar+'"></div>',n+=is_active?'<div class="com_info_tit com-act">':'<div class="com_info_tit">',n+=' <div class="nick" data-uid="'+t.from_uid+'"  data-nick="'+t.nick+'">',v_uid==t.from_uid&&(n+='<span class="i_upz"></span>'),n+=t.nick,n+=' </div>                                <div class="created">'+t.created+'</div>                            </div>                            <div class="btn_reply  hashover" data-cid="'+t.id+'" data-nick="'+t.nick+'"  data-uid="'+t.from_uid+'" data-froot="1"><i></i></div>                       </div>                       <div class="content" data-cid="'+t.id+'" data-nick="'+t.nick+'" data-uid="'+t.from_uid+'" data-froot="1">'+t.content+'</div>                       <div class="reply_list" id="reply_list_'+(t.id||0)+'" '+(0==t.child.length?'style="display:none;"':"")+">                <ul>";for(var o=0;o<t.child.length;o++)e=t.child[o],n+='<li class="reply">                                         <div class="reply_meta clearfix"  id="r_'+e.parent_id+"_"+e.id+'" data-nick="'+e.nick+'"  data-uid="'+e.from_uid+'"  data-froot="'+e.from_root+'">                                                <span class="j-reply_nick"  data-uid="'+e.from_uid+'" data-nick="'+e.nick+'">',v_uid==e.from_uid&&(n+='<span class="i_upz"></span>'),n+=' <span class="reply_nick">'+e.nick+"</span> ",0==e.from_root&&(n+='</span><span class="re_txt">回复</span>                                                 <span class="j-reply_nick" data-uid="'+e.to_uid+'" data-nick="'+e.to_uid_author+'">',v_uid==e.to_uid&&(n+='<span class="i_upz"></span>'),n+=' <span class="reply_nick">@'+e.to_uid_author+"</span>"),n+='</span><span class="reply_content">：'+e.content+"</span>                                        </div>                    </li>";if(n+="</ul>",t.child_more&&t.child_total>5){var a=parseInt(t.child_total-5);a>0&&(n+='<div class="load_more hashover load_more_reply"  data-cid="'+t.relate_id+'"  data-chid="'+e.parent_id+'"  data-more="'+t.child_more+'" data-ctotal="'+t.child_total+'">更多<em>'+a+"</em>条回复</div>")}return n+="</div>",i.innerHTML=n,[i]},newComment:function(t,e,i,n,o,a,r,c){var s,d=this,l=document.getElementById("j-load_more_comment"),m=document.getElementById("j-comment_list"),u=m.getElementsByClassName("item"),_={avatar:o,content:d.parseContent(e),created:"刚刚",nick:i||"4399网友",cid:t||0,from_uid:n,from_vip:a,from:d.parseDevice(r,c)},p="";if(p+='<div class="com_info_hd">                                <div class="avatar" data-uid="'+_.from_uid+'" data-nick="'+_.nick+'">',1==parseInt(_.from_vip)&&(p+='<div class="i_vip pa"></div>'),p+='<img src="'+_.avatar+'"> </div>',p+=is_active?'<div class="com_info_tit com-act">':'<div class="com_info_tit">',p+=' <div class="nick" data-uid="'+_.from_uid+'" data-nick="'+_.nick+'">',v_uid==_.from_uid&&(p+='<span class="i_upz"></span>'),p+=_.nick,p+=' </div>                                    <div class="created">'+_.created+'</div>                                </div>                                <div class="btn_reply  hashover" data-cid="'+_.cid+'" data-uid="'+_.from_uid+'" data-nick="'+_.nick+'" data-froot="1"><i></i></div>                            </div>                            <div class="content" data-cid="'+_.cid+'" data-uid="'+_.from_uid+'" data-nick="'+_.nick+'" data-froot="1">'+_.content+'</div>                            <div class="reply_list" id="reply_list_'+_.cid+'" style="display:none;">                              <ul></ul>                         </div>',s=document.createElement("li"),s.className="item",s.id="comment_id_"+(_.cid||0),s.innerHTML=p,0==u.length?(classList.remove(l,"loading"),classList.add(l,"nodata"),l.innerHTML=" ",num=1):num++,m.insertBefore(s,m.childNodes[0]),document.getElementById("j-comment_count").innerHTML=num,d.onresize(),d.newCommentScrollTop){var v=parseInt($("#j-com_container").attr("data-offtop"));window.scrollTo(0,v)}},newReply:function(t,e,i,n,o,a,r,c){var s,d,l,m,u=document.getElementById("reply_list_"+t),_=this,p={c_pid:t||0,cid:e||0,content:_.parseContent(i),from_nick:n||"4399网友",from_uid:o,from_root:parseInt(a),from:_.parseDevice(r,c)};u&&(s=u.getElementsByTagName("ul")[0],d=s.getElementsByClassName("reply"),l='<div class="reply_meta clearfix" id="r_'+p.c_pid+"_"+p.cid+'" data-nick="'+p.from_nick+'"  data-uid="'+p.from_uid+'" data-froot="'+p.from_root+'">                           <span class="j-reply_nick" data-uid="'+p.from_uid+'" data-nick="'+p.from_nick+'"> ',v_uid==p.from_uid&&(l+='  <span class="i_upz"></span>'),l+='<span class="reply_nick">'+p.from_nick+"</span>",l+='  </span><span class="reply_content">：'+p.content+"</span>                       </div>",m=document.createElement("li"),m.className="reply reply_meta_li",m.innerHTML=l,0==d.length&&(u.style.display="block"),s.appendChild(m),_.onresize(),_.newCommentScrollTop&&_.winscrTo(u))},newReplyChild:function(t,e,i,n,o,a,r,c,s,d){var l,m,u,_=document.getElementById("reply_list_"+t),p=this,v={c_pid:t||0,cid:e||0,content:p.parseContent(i),from_nick:n||"4399网友",from_uid:o,to_nick:a||"4399网友",to_uid:r,from_root:parseInt(c),from:p.parseDevice(s,d)};_&&(l=_.getElementsByTagName("ul")[0],l.getElementsByClassName("reply"),m='<div class="reply_meta clearfix" id="r_'+v.c_pid+"_"+v.cid+'" data-nick="'+v.from_nick+'"  data-uid="'+v.from_uid+'" data-froot="'+v.from_root+'">                           <span class="j-reply_nick" data-uid="'+v.from_uid+'" data-nick="'+v.from_nick+'">',v_uid==o&&(m+='  <span class="i_upz"></span>'),m+='<span class="reply_nick">'+v.from_nick+"</span> ",m+='   </span><span class="re_txt">回复</span>                           <span class="j-reply_nick" data-uid="'+v.to_uid+'" data-nick="'+v.to_nick+'">',v_uid==v.to_uid&&(m+='<span class="i_upz"></span>'),m+='<span class="reply_nick">@'+v.to_nick+"</span>",m+='  </span><span class="reply_content">：'+v.content+"</span>                       </div>",u=document.createElement("li"),u.className="reply reply_meta_li",u.innerHTML=m,l.appendChild(u),p.onresize(),p.newCommentScrollTop&&p.winscrTo(_))},winscrTo:function(t){var e,i=$("#j-com_container").find(".m_hd").height(),n=$("#j-v_comment_form").height(),o=$(t).parents(".item").next();if(o=0==o.length?"":o){var a=o.offset().top;e=parseInt(a-i-n-30)}else e=$("#j-comment").height()+v_height;$(window).scrollTop(e)},delComm:function(t){var e=this;if(comId)if("object"==typeof comId){var i="#comment_id_"+comId[1],n="#r_"+comId[1]+"_"+comId[2];t?1==parseInt(t)&&$(n).parent().remove():e.comidDel(i)}else{var i="#comment_id_"+comId;e.comidDel(i)}},routDelCom:function(t,e){var i,n,o=this;t&&(i="#comment_id_"+t,e&&-1!=e?(n="#r_"+t+"_"+e,$(n).parent().remove()):o.comidDel(i))},comidDel:function(t){var e=document.getElementById("j-load_more_comment");if($(t).remove(),num=parseInt(num-1),document.getElementById("j-comment_count").innerHTML=num,num<=0)return classList.add(e,"nodata_tip"),void(e.innerHTML="<div class='com_none'></div><div class='com-tip'>期待你的精彩评论！</div>")},async:function(t,e,i){var n=document.createElement("script"),o="JSONP"+(new Date-0);e="function"==typeof e?e:function(){},i="function"==typeof i?i:function(){},window[o]=e,n.onload=function(t){document.body.removeChild(n),delete window[o]},n.onerror=function(t){i(),document.body.removeChild(n),delete window[o]},t.indexOf("?")>=0?t+="&_callback_="+o:t+="?_callback_="+o,n.src=t,document.body.appendChild(n)},onresize:function(){},htmlEncode:function(t){var e="",i=/^[^\<>]*$/;return 0==t.length?"":i.test(t)?t:(e=t.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/ /g,"&nbsp;"),e=e.replace(/\'/g,"&#39;"),e=e.replace(/\"/g,"&quot;"),e=e.replace(/\n/g,"<br>"))}},window.commInstant=function(t,e,i){if(Emt.isYoupai&&Emt.isIDevice){var n;callMobile("Native","initComment"),window.initComment=function(t,e,i,o){n=i},window.initCommentFrontEnd=function(t,e,i,n){m_comment=new M_Comment(0,!0,!0),m_comment.init(t,e,i,n)},setTimeout(function(){initCommentFrontEnd(t,e,n,i)},500);var o={init:function(){comAPI.getUid=getUid,comAPI.visitPersonPage=visitPersonPage,comAPI.toReply=toReply,comAPI.toReplyChild=toReplyChild,comAPI.setCommentCount=setCommentCount,comAPI.toDelete=toDelete,comAPI.toComment=toComment,comAPI.onJsToast=window.onJsToast,comAPI.onJsPlayVideo=window.onJsPlayVideo}};if(Emt.isYoupai&&0==is_iOS_wkwebview){if(ckYpVernum>="1.8.0")return!1;ckYpVernum>="1.6.0"&&o.init()}}0==is_iOS_wkwebview&&("function"==typeof comAPI.getUid&&(uid=comAPI.getUid()),m_comment=new M_Comment(0,!0,!0),m_comment.init(t,e,uid,i))};